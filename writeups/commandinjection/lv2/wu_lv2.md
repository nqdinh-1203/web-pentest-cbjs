# Command Injection Level 2

## __1. Sử dụng như người dùng:__
Giao diện như ở Level 1.

Dùng Payload ở Lv1 thì sẽ hiển thị  
![](1.PNG)  
&rarr; Khắc phục được Bug ở Lv1

## __2. Xem đằng sau chương trình:__
Đoạn code mới:
```php
<?php
    if(isset($_POST['command'],$_POST['target'])){
        $command = $_POST['command'];
        $target = $_POST['target'];
        if (strpos($target, ";") !== false) 
            die("Hacker detected!");
		switch($command) {
			case "ping":
				$result = shell_exec("timeout 10 ping -c 4 $target &2 > 1");
				break;
			case "nslookup":
				$result = shell_exec("timeout 10 nslookup $target &2 > 1");
				break;	
			case "dig":
				$result = shell_exec("timeout 10 dig $target &2 > 1");
				break;
		}
		die($result);
    }
?>
```
Cũng như ở Lv1 nhưng có 1 khúc `if` để chặn `target` có ký tự `;`

## __3. Lên ý tưởng và Khai thác:__
Như mình đã tìm hiểu ở Lv1 các cách chạy nhiều command trên 1 dòng rồi. Ngoài `;` ra thì ta có thể dùng `||`.  
Và Payload sẽ tương tự.

### Khai thác:
Payload: `|| ls #`  
![](2.PNG)

Vậy mình cũng đã RCE thành công và lấy `flag` thôi.

![](3.PNG)
> CBJS{FAKE_FLAG_FAKE_FLAG}