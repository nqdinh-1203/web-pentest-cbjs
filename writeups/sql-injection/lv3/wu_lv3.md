# SQL Injection Level 3

## __1. Sử dụng như người dùng:__
Giao diện không thay đổi nhưng dùng các payload ở lv trước không được. Có vẻ như anh Dev lại fix thêm.

## __2. Xem đằng sau chương trình:__
File `level3.php`:  
```php
<?php
if (isset($_POST["username"]) && isset($_POST["password"])) {
    try {
        include "db.php";
        $sql = "SELECT username FROM users WHERE username=LOWER('" .$_POST["username"] . "') AND password=MD5('" . $_POST["password"] ."')";
        $db_result = $database->query($sql);
        if ($db_result->num_rows > 0){
            $row = $db_result->fetch_assoc(); // Get the first row
            $username = $row["username"];
            if ($username === "admin") {
                $message = "Wow you can log in as admin, so cool, but how about <a href='level4.php'>THIS LEVEL</a>!";
            }
            else
                $message = "You log in as $username, but then what? You are not an admin";
        }
        else {
            $message = "Wrong username or password";
        }
    } catch(mysqli_sql_exception $e) {
        $message = $e->getMessage();
    }
}
?>
```
Có vẻ như không khác gì ở lv2 và ở lv3 thì đổi lại ký tự mở đóng chuỗi lại thành `'` bên cạnh đó sử dụng hàm `LOWER()` để chuyển thành chữ cái thường.

## __3. Lên ý tưởng và Khai thác:__
### <ins>Khai thác</ins>:
Không khác gì ở lv1 vì mình không sử dụng chữ cái hoa nào cả. Nhưng có lưu ý là mình phải thêm ký tự `)` để đóng hàm `LOWER` trước khi `comment`.  

__Payload:__
```sql
admin')-- 
```
Mình sẽ dùng Payload vào `username input` và `password input` mình nhập bất kỳ.