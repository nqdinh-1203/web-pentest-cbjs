# SQL Injection Level 2

## __1. Sử dụng như người dùng:__
Giao diện vẫn như ở lv1 nhưng khi sử dụng payload ở lv1 thì không hoạt động.

## __2. Xem đằng sau chương trình:__
File `level2.php`:
```php
<?php
if (isset($_POST["username"]) && isset($_POST["password"])) {
    try {
        include "db.php";
        $sql = "SELECT username FROM users WHERE username=\"" .$_POST["username"] . "\" AND password=MD5(\"" . $_POST["password"] ."\")";
        $db_result = $database->query($sql);
        if ($db_result->num_rows > 0){
            $row = $db_result->fetch_assoc(); // Get the first row
            $username = $row["username"];
            if ($username === "admin") {
                $message = "Wow you can log in as admin, so cool, but how about <a href='level3.php'>THIS LEVEL</a>!";
            }
            else
                $message = "You log in as $username, but then what? You are not an admin";
        }
        else {
            $message = "Wrong username or password";
        }
    } catch(mysqli_sql_exception $e) {
        $message = $e->getMessage();
    }
}
?>
```
Ở câu `query` vẫn `select` `username` nhưng lúc này ký tự `"` để mở đóng chuỗi và ở password sử dụng `hàm bằm md5` cho `password`. Và những phần khác không thay đổi.

## __3. Lên ý tưởng và Khai thác:__
### <ins>Khai thác</ins>:
Trong câu query sử dung `"` để đóng mở chuỗi thì vẫn sẽ có payload như ở lv1 thay ký tự `'` &rarr; `"`

__Payload:__
```sql
admin"-- 
```
Mình sẽ dùng Payload vào `username input` và `password input` mình nhập bất kỳ.  
![](2.PNG)